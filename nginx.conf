server {
    listen 8080 default_server;
    listen [::]:8080 default_server;
    root /var/www/html/public; # Garanta que a raiz aponte para a pasta public

    index index.php index.html;

    # Adicionar as configurações do CORS aqui
    location / {
        try_files $uri $uri/ /index.php?$query_string;

        # === CORREÇÃO CORS DO NGINX ===
        # Permite a origem específica (Vercel)
        add_header 'Access-Control-Allow-Origin' '*';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'Authorization, Content-Type';
        add_header 'Access-Control-Allow-Credentials' 'true';

        # Lida com requisições OPTIONS (preflight)
        if ($request_method = 'OPTIONS') {
            return 204;
        }
        # ================================
    }
    
    # ... (bloco location ~ \.php$ continua aqui)
}